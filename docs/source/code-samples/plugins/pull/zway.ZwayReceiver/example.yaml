#
# Registers the /zway endpoint to the builtin api server.
#
# Use the manual mapping of device names
#   curl -X GET "http://localhost:9999/zway?device=vdevice1&value=on"
#
# Use the automapper:
#   curl -X GET "http://localhost:9999/zway?device=ZWayVDev_zway_21-0-49-1&value=21.2"
#
# Unknown device (no manual mapping and no automapping possible)
#   curl -X GET "http://localhost:9999/zway?device=unknown&value=off"
#

api:  # You need to enable the api
  port: 9999
tasks:
  - name: zway_receiver
    pull:
      plugin: pnp.plugins.pull.zway.ZwayReceiver
      args:
        mode: both  # mapping, auto or both
        device_mapping:
          vdevice1:  # Props = {type: motion}
            alias: dev1
            type: motion
          vdevice2:  # Props = {type: switch, other_prop: foo}
            alias: dev2
            type: switch
            other_prop: foo
          vdevice3: dev3  # props == {}
        ignore_unknown_devices: false
    push:
      - plugin: pnp.plugins.push.simple.Echo
        selector: "'Received value `{}` from device `{}` ({}) with props {}'.format(data.value, data.device_name, data.raw_device, data.props)"
